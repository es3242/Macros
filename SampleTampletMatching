package satisfactionSurvey;
import org.opencv.core.Core;
import org.opencv.core.Core.MinMaxLocResult;
import org.opencv.core.Mat;
import org.opencv.core.Point;
import org.opencv.core.Scalar;
import org.opencv.imgcodecs.Imgcodecs;
import org.opencv.imgproc.Imgproc;
import java.awt.*;
import java.awt.event.*;

public class SampleTampletMatching {
	
	 public static void main(String[] args) {
	        
			//System.load("C:/Users/sku/Downloads/OpenCV/build/java/x64/opencv_java455.dll");
	        System.loadLibrary(Core.NATIVE_LIBRARY_NAME);
	        Mat source=null;
	        Mat template=null;
	        //String filePath="C:/Users/sku/Desktop/obdtest/";
	        String filePath="C:/Users/cpfld/git/Macros/src/satisfactionSurvey/";
	        //Load image file
	        source=Imgcodecs.imread(filePath+"test_src.png");
	        template=Imgcodecs.imread(filePath+"test_templit.png");
	    
	        Mat outputImage=new Mat();    
	        int machMethod=Imgproc.TM_CCORR_NORMED;
	        //Template matching method
	        Imgproc.matchTemplate(source, template, outputImage, machMethod);
	 
	    
	        MinMaxLocResult mmr = Core.minMaxLoc(outputImage);
	        Point matchLoc=mmr.maxLoc;
	        //Draw rectangle on result image
	        Imgproc.rectangle(source, matchLoc, new Point(matchLoc.x + template.cols(),
	                matchLoc.y + template.rows()), new Scalar(0, 255, 255));
	        
	        System.out.println(matchLoc.x +" " +matchLoc.y);
	        System.out.println(template.cols() +" " +template.rows());



	 
	        Imgcodecs.imwrite(filePath+"sonuc.jpg", source);
	        System.out.println("Complated.");
	        
	        
	        try {
	            
	            Robot robot = new Robot();
	           
	            //robot.delay(5000); //5초 딜레이
	           
	            
	            //robot.keyPress(KeyEvent.VK_O);
	           
	            Rectangle screenRect = new Rectangle();
	            //커서를 절대좌표 300,300으로 이동
	            robot.mouseMove(672, 1162);
	            robot.delay(5000);
	            robot.createScreenCapture(screenRect);
	            robot.mouseMove(789, 1307);
	            
	        } catch (AWTException e) {
	            e.printStackTrace();
	        }
	    }
	
	 


	    }
